<!-- pages/index/index.wxml -->
<view class="container">
  <!-- 轮播图 -->
  <swiper class="banner-swiper" indicator-dots="{{indicatorDots}}" autoplay="{{autoplay}}" interval="{{interval}}" duration="{{duration}}">
    <block wx:for="{{banners}}" wx:key="index">
      <swiper-item>
        <image src="{{item.image}}" class="slide-image" mode="aspectFill" bind:tap="onBannerTap" data-index="{{index}}"></image>
      </swiper-item>
    </block>
  </swiper>


  <!-- 订单统计 -->
  <view class="page-section">
    <view class="section-title">
      <text class="title-text">订单统计</text>
    </view>
    <view class="stats-container flex-row justify-between">
      <view class="stat-item">
        <text class="stat-number">{{stats.pending}}</text>
        <text class="stat-label">待接单</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{stats.assigned}}</text>
        <text class="stat-label">已分配</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{stats.inProgress}}</text>
        <text class="stat-label">进行中</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{stats.completed}}</text>
        <text class="stat-label">已完成</text>
      </view>
    </view>
  </view>

  <!-- 推荐拉新横幅 -->
  <view class="page-section" wx:if="{{referralCampaign}}">
    <view class="referral-banner">
      <view class="referral-content">
        <view class="referral-title">{{referralCampaign.campaign_title}}</view>
        <view class="referral-desc">{{referralCampaign.campaign_description}}</view>
        <view class="referral-reward">
          <text class="reward-text">推荐奖励: ¥{{referralCampaign.referral_reward_amount}}</text>
          <text class="referee-reward-text">被推荐奖励: ¥{{referralCampaign.referee_reward_amount}}</text>
        </view>
      </view>
      <view class="referral-button">立即参与</view>
    </view>
  </view>

  <!-- 最新订单 -->
  <view class="page-section">
    <view class="section-title">
      <text class="title-text">最新订单</text>
    </view>
    <view class="order-list">
      <block wx:for="{{recentOrders}}" wx:key="id">
        <view class="order-card" bind:tap="viewOrderDetail" data-id="{{item.id}}">
          <view class="order-header">
            <text class="order-title">{{item.title}}</text>
            <text class="order-status status-{{item.status}}">{{getStatusText(item.status)}}</text>
          </view>
          <view class="order-body">
            <view class="order-detail-item">
              <text>取货地址:</text>
              <text>{{item.pickup_address}}</text>
            </view>
            <view class="order-detail-item">
              <text>送货地址:</text>
              <text>{{item.delivery_address}}</text>
            </view>
            <view class="order-detail-item">
              <text>金额:</text>
              <text>¥{{item.amount}}</text>
            </view>
          </view>
          <view class="order-footer">
            <button class="btn-primary" bind:tap="viewOrderDetail" data-id="{{item.id}}" catch:tap="stopPropagation">查看详情</button>
          </view>
        </view>
      </block>
    </view>
    <view wx:if="{{recentOrders.length === 0}}" class="empty-state">
      <text class="empty-text">暂无订单</text>
    </view>
  </view>
</view>